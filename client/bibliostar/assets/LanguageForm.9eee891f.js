import{R as b,P as w,b1 as q,r as v,aw as x,bb as I,V as k,W as Q,X as l,$ as a,Z as t,_ as p,x as S,a3 as V,Y as i,aA as C,az as E,b2 as g}from"./index.3de14beb.js";import{Q as T}from"./QForm.56ccee4c.js";import{Q as $}from"./QPage.ea495e0d.js";const P={class:"flex justify-between"},j={class:"row q-gutter-sm items-center q-mb-md q-pt-sm"},z={class:"text-h5 text-weight-medium font-title text-grey-9"},B={class:"text-right font-title"},F={class:"row"},N={class:"col-12"},D={__name:"LanguageForm",setup(O){const c=b(),_=w(),d=q(),h=v(!1),m=!!(d.path.includes("editar")&&d.params.id),r=x({record:{cod_idioma:"",descripcion:"",session_user_name:localStorage.getItem("usuario"),session_user_role:localStorage.getItem("rol")}}),f=async()=>{try{if(m){const s={method:"GET",headers:{"Content-Type":"application/json"}},e=`http://localhost/bibliostar/API/idiomas.php?cod_idioma=${d.params.id}&session_user_name=${localStorage.getItem("usuario")}&session_user_role=${localStorage.getItem("rol")}`,o=await fetch(e,s);if(!o.ok)throw new Error(o.statusText);const u=await o.json();if(u.error)throw new Error(u.error);r.record=u[0],r.record.session_user_name=localStorage.getItem("usuario"),r.record.session_user_role=localStorage.getItem("rol")}}catch(s){c.notify({color:"negative",position:"top",message:s.message,icon:"mdi-alert"})}},y=async()=>{try{const s={method:m?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r.record)},e=await fetch("http://localhost/bibliostar/API/idiomas.php",s);if(!e.ok)throw new Error(e.statusText);const o=await e.json();if(o.error)throw new Error(o.error);c.notify({color:"positive",position:"top",message:o.success,icon:"mdi-checkbox-marked-circle"}),_.push({path:"/idiomas"})}catch(s){c.notify({color:"negative",position:"top",message:s.message,icon:"mdi-alert"})}};f();const{record:n}=I(r);return(s,e)=>(k(),Q($,{class:"q-px-lg q-py-sm"},{default:l(()=>[a("div",P,[a("div",j,[t(p,{icon:"mdi-chevron-left",flat:"",color:"primary",padding:"none",to:"/idiomas",size:"lg",class:"q-mr-sm"}),t(S,{name:"mdi-book-open-blank-variant-outline",size:"md",color:"grey-9"}),a("div",z,V(i(m)?"Editar":"Nuevo")+" Idioma ",1)]),a("div",B,[t(p,{size:"md",class:"q-my-md",loading:h.value,color:"primary",padding:"sm md",icon:"mdi-check-circle-outline",label:"Guardar",onClick:y},null,8,["loading"])])]),t(T,null,{default:l(()=>[t(C,null,{default:l(()=>[a("div",F,[a("div",N,[t(E,{class:"q-pb-none"},{default:l(()=>[t(g,{modelValue:i(n).cod_idioma,"onUpdate:modelValue":e[0]||(e[0]=o=>i(n).cod_idioma=o),label:"Idioma",class:"required q-my-md",outlined:""},null,8,["modelValue"]),t(g,{modelValue:i(n).descripcion,"onUpdate:modelValue":e[1]||(e[1]=o=>i(n).descripcion=o),label:"Descrici\xF3n",class:"required q-my-md",outlined:""},null,8,["modelValue"])]),_:1})])])]),_:1})]),_:1})]),_:1}))}};export{D as default};
