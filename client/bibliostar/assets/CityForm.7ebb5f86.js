import{R as b,P as w,b1 as q,r as v,aw as x,bb as C,V,W as I,X as n,$ as i,Z as s,_ as g,x as Q,a3 as S,Y as a,aA as k,az as E,b2 as p}from"./index.3de14beb.js";import{Q as T}from"./QForm.56ccee4c.js";import{Q as $}from"./QPage.ea495e0d.js";const P={class:"flex justify-between"},j={class:"row q-gutter-sm items-center q-mb-md q-pt-sm"},z={class:"text-h5 text-weight-medium font-title text-grey-9"},B={class:"text-right font-title"},F={class:"row"},N={class:"col-12"},G={__name:"CityForm",setup(O){const c=b(),_=w(),u=q(),f=v(!1),l=!!(u.path.includes("editar")&&u.params.id),d=x({record:{codigo_pais:"",codigo_ciudad:"",ciudad:"",session_user_name:localStorage.getItem("usuario"),session_user_role:localStorage.getItem("rol")}}),h=async()=>{try{if(l){const t={method:"GET",headers:{"Content-Type":"application/json"}},o=`http://localhost/bibliostar/API/ciudades.php?codigo_ciudad=${u.params.id}&session_user_name=${localStorage.getItem("usuario")}&session_user_role=${localStorage.getItem("rol")}`,e=await fetch(o,t);if(!e.ok)throw new Error(e.statusText);const m=await e.json();if(m.error)throw new Error(m.error);d.record=m[0],d.record.session_user_name=localStorage.getItem("usuario"),d.record.session_user_role=localStorage.getItem("rol")}}catch(t){c.notify({color:"negative",position:"top",message:t.message,icon:"mdi-alert"})}},y=async()=>{try{const t={method:l?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d.record)},o=await fetch("http://localhost/bibliostar/API/ciudades.php",t);if(!o.ok)throw new Error(o.statusText);const e=await o.json();if(e.error)throw new Error(e.error);c.notify({color:"positive",position:"top",message:e.success,icon:"mdi-checkbox-marked-circle"}),_.push({path:"/ciudades"})}catch(t){c.notify({color:"negative",position:"top",message:t.message,icon:"mdi-alert"})}};h();const{record:r}=C(d);return(t,o)=>(V(),I($,{class:"q-px-lg q-py-sm"},{default:n(()=>[i("div",P,[i("div",j,[s(g,{icon:"mdi-chevron-left",flat:"",color:"primary",padding:"none",to:"/ciudades",size:"lg",class:"q-mr-sm"}),s(Q,{name:"mdi-home-city",size:"md",color:"grey-9"}),i("div",z,S(a(l)?"Editar":"Nueva")+" Ciudad ",1)]),i("div",B,[s(g,{size:"md",class:"q-my-md",loading:f.value,color:"primary",padding:"sm md",icon:"mdi-check-circle-outline",label:"Guardar",onClick:y},null,8,["loading"])])]),s(T,null,{default:n(()=>[s(k,null,{default:n(()=>[i("div",F,[i("div",N,[s(E,{class:"q-pb-none"},{default:n(()=>[s(p,{modelValue:a(r).codigo_ciudad,"onUpdate:modelValue":o[0]||(o[0]=e=>a(r).codigo_ciudad=e),label:"C\xF3digo de ciudad",class:"required q-my-md",outlined:"",disable:a(l)},null,8,["modelValue","disable"]),s(p,{modelValue:a(r).ciudad,"onUpdate:modelValue":o[1]||(o[1]=e=>a(r).ciudad=e),label:"Ciudad",class:"required q-my-md",outlined:""},null,8,["modelValue"]),s(p,{modelValue:a(r).codigo_pais,"onUpdate:modelValue":o[2]||(o[2]=e=>a(r).codigo_pais=e),label:"C\xF3digo de pais",class:"required q-my-md",outlined:""},null,8,["modelValue"])]),_:1})])])]),_:1})]),_:1})]),_:1}))}};export{G as default};
