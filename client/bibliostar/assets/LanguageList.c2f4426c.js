import{R as $,r as b,aw as C,V as T,W as S,X as a,$ as i,Z as o,x as k,_ as c,b2 as x,a2 as f,aA as N,Y as j}from"./index.3de14beb.js";import{Q as _}from"./QTooltip.2c191821.js";import{Q as z}from"./QTd.4e40a178.js";import{Q as A}from"./QTable.bd81f58f.js";import{Q as L}from"./QPage.ea495e0d.js";import"./QMenu.ba121aec.js";import"./QList.d82f2d18.js";import"./QSelect.dcde8888.js";import"./QItem.5c0ffacc.js";import"./format.054b8074.js";const B={class:"row justify-between items-center q-gutter-x-xl q-gutter-y-md q-mb-md q-pt-sm"},D={class:"col-md-6"},O={class:"row q-gutter-sm items-center"},R={class:"col-auto"},U={class:"row justify-between content-end items-center q-col-gutter-sm"},F={class:"col-auto"},G={class:"row items-center"},J={class:"col-xs-12 col-lg-auto"},W={class:"row items-center q-gutter-md"},X={class:"col-auto"},Y={class:"col-auto"},Z={class:"col-auto self-end"},de={__name:"LanguageList",setup(H){const m=$(),u=b({page:1,rowsPerPage:10,rowsNumber:0}),n=C({cod_idioma:"",descripcion:""}),y=b([]),v=b(!1),Q=[{name:"cod_idioma",label:"C\xF3digo de idioma",field:"cod_idioma",align:"left"},{name:"descripcion",label:"Descripci\xF3n",field:s=>s.descripcion&&s.descripcion.trim()!=""?s.descripcion:"--",align:"left"},{name:"actions",label:"Acciones",align:"left"}],E=s=>{m.dialog({title:"Eliminar idioma",message:`\xBFEst\xE1s seguro de que deseas eliminar este idioma? (${s.cod_idioma})`,cancel:!0,persistent:!0}).onOk(async()=>{try{const e={method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({cod_idioma:s.cod_idioma,session_user_name:localStorage.getItem("usuario"),session_user_role:localStorage.getItem("rol")})},r=await fetch("http://localhost/bibliostar/API/idiomas.php",e);if(!r.ok)throw new Error(r.statusText);const d=await r.json();if(d.error)throw new Error(d.error);m.notify({color:"positive",position:"top",message:"Idioma eliminado correctamente",icon:"mdi-check"}),p()}catch(e){m.notify({color:"negative",position:"top",message:e.message,icon:"mdi-alert"})}})},p=async(s=1)=>{var e,t,r;try{const d={method:"GET",headers:{"Content-Type":"application/json"}};let h=`http://localhost/bibliostar/API/idiomas.php?page=${s}&session_user_name=${localStorage.getItem("usuario")}&session_user_role=${localStorage.getItem("rol")}`,g=new URLSearchParams(n),q=[];g.forEach((w,V)=>{w.trim()==""&&q.push(V)}),q.forEach(w=>{g.delete(w)}),g.toString()!=""&&(h+=`&${g.toString()}`),v.value=!0;const l=await(await fetch(h,d)).json();y.value=l.data?l.data:[],u.value.rowsNumber=(e=l.pagination)!=null&&e.total?l.pagination.total:0,u.value.page=(t=l.pagination)!=null&&t.currentPage?l.pagination.currentPage:1,u.value.rowsPerPage=(r=l.pagination)!=null&&r.perPage?l.pagination.perPage:10}catch(d){m.notify({color:"negative",position:"top",message:d.message,icon:"mdi-alert"})}finally{v.value=!1}},I=s=>{p(s.pagination.page)},P=()=>{n.cod_idioma="",n.descripcion=""};return p(),(s,e)=>(T(),S(L,{class:"q-py-md q-px-lg"},{default:a(()=>[i("div",B,[i("div",D,[i("div",O,[o(k,{name:"mdi-book-open-blank-variant-outline",size:"lg",color:"primary"}),e[4]||(e[4]=i("div",{class:"text-h4 text-weight-medium font-title"},"Idiomas",-1))])]),i("div",R,[o(c,{label:"Nuevo Idioma",icon:"mdi-plus-circle",color:"secondary","text-color":"white",to:"/idiomas/nuevo"})])]),o(N,{class:"q-pa-md q-mb-lg"},{default:a(()=>[i("div",U,[i("div",F,[i("div",G,[i("div",J,[i("div",W,[o(k,{name:"mdi-filter-variant",size:"lg",color:"grey-10"}),i("div",X,[o(x,{modelValue:n.cod_idioma,"onUpdate:modelValue":e[0]||(e[0]=t=>n.cod_idioma=t),outlined:"",dense:"",debounce:"400",label:"C\xF3digo de idioma"},null,8,["modelValue"])]),i("div",Y,[o(x,{modelValue:n.descripcion,"onUpdate:modelValue":e[1]||(e[1]=t=>n.descripcion=t),outlined:"",dense:"",debounce:"400",label:"Descripci\xF3n"},null,8,["modelValue"])])])])])]),i("div",Z,[o(c,{flat:"",size:"lg","no-caps":"",icon:"mdi-eraser",color:"negative",onClick:P}),o(c,{flat:"",size:"lg","no-caps":"",icon:"mdi-reload",color:"primary",class:"q-ml-sm",onClick:e[2]||(e[2]=t=>p())},{default:a(()=>[o(_,null,{default:a(()=>e[5]||(e[5]=[f(" Actualizar tabla ")])),_:1})]),_:1})])])]),_:1}),o(A,{flat:"",dense:j(m).screen.lt.lg,bordered:"",pagination:u.value,"onUpdate:pagination":e[3]||(e[3]=t=>u.value=t),rows:y.value,columns:Q,filter:n,loading:v.value,"row-key":"cod_idiomas","rows-per-page-options":[],onRequest:I},{"body-cell-actions":a(t=>[o(z,{props:t},{default:a(()=>[o(c,{flat:"",round:"",icon:"mdi-eye",color:"positive",to:`/idiomas/idioma/${t.row.cod_idioma}`},{default:a(()=>[o(_,null,{default:a(()=>e[6]||(e[6]=[f("Ver")])),_:1})]),_:2},1032,["to"]),o(c,{flat:"",round:"",icon:"mdi-lead-pencil",color:"accent",to:`/idiomas/editar/${t.row.cod_idioma}`},{default:a(()=>[o(_,null,{default:a(()=>e[7]||(e[7]=[f("Editar")])),_:1})]),_:2},1032,["to"]),o(c,{flat:"",round:"",icon:"mdi-delete-variant",color:"red",onClick:r=>E(t.row)},{default:a(()=>[o(_,null,{default:a(()=>e[8]||(e[8]=[f("Eliminar")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["dense","pagination","rows","filter","loading"])]),_:1}))}};export{de as default};
