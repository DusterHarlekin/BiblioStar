import{R as b,P as w,b1 as q,r as v,aw as x,bb as I,V as Q,W as S,X as c,$ as a,Z as t,_ as p,x as k,a3 as C,Y as r,aA as V,az as P,b2 as g}from"./index.3de14beb.js";import{Q as E}from"./QForm.56ccee4c.js";import{Q as T}from"./QPage.ea495e0d.js";const $={class:"flex justify-between"},j={class:"row q-gutter-sm items-center q-mb-md q-pt-sm"},z={class:"text-h5 text-weight-medium font-title text-grey-9"},B={class:"text-right font-title"},F={class:"row"},N={class:"col-12"},G={__name:"CountryForm",setup(O){const d=b(),_=w(),m=q(),h=v(!1),n=!!(m.path.includes("editar")&&m.params.id),i=x({record:{codigo:"",pais:"",session_user_name:localStorage.getItem("usuario"),session_user_role:localStorage.getItem("rol")}}),f=async()=>{try{if(n){const o={method:"GET",headers:{"Content-Type":"application/json"}},s=`http://localhost/bibliostar/API/paises.php?codigo=${m.params.id}&session_user_name=${localStorage.getItem("usuario")}&session_user_role=${localStorage.getItem("rol")}`,e=await fetch(s,o);if(!e.ok)throw new Error(e.statusText);const u=await e.json();if(u.error)throw new Error(u.error);i.record=u[0],i.record.session_user_name=localStorage.getItem("usuario"),i.record.session_user_role=localStorage.getItem("rol")}}catch(o){d.notify({color:"negative",position:"top",message:o.message,icon:"mdi-alert"})}},y=async()=>{try{const o={method:n?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i.record)},s=await fetch("http://localhost/bibliostar/API/paises.php",o);if(!s.ok)throw new Error(s.statusText);const e=await s.json();if(e.error)throw new Error(e.error);d.notify({color:"positive",position:"top",message:e.success,icon:"mdi-checkbox-marked-circle"}),_.push({path:"/paises"})}catch(o){d.notify({color:"negative",position:"top",message:o.message,icon:"mdi-alert"})}};f();const{record:l}=I(i);return(o,s)=>(Q(),S(T,{class:"q-px-lg q-py-sm"},{default:c(()=>[a("div",$,[a("div",j,[t(p,{icon:"mdi-chevron-left",flat:"",color:"primary",padding:"none",to:"/paises",size:"lg",class:"q-mr-sm"}),t(k,{name:"mdi-map-marker",size:"md",color:"grey-9"}),a("div",z,C(r(n)?"Editar":"Nuevo")+" Pa\xEDs ",1)]),a("div",B,[t(p,{size:"md",class:"q-my-md",loading:h.value,color:"primary",padding:"sm md",icon:"mdi-check-circle-outline",label:"Guardar",onClick:y},null,8,["loading"])])]),t(E,null,{default:c(()=>[t(V,null,{default:c(()=>[a("div",F,[a("div",N,[t(P,{class:"q-pb-none"},{default:c(()=>[t(g,{modelValue:r(l).codigo,"onUpdate:modelValue":s[0]||(s[0]=e=>r(l).codigo=e),label:"C\xF3digo de pa\xEDs",class:"required q-my-md",outlined:"",disable:r(n)},null,8,["modelValue","disable"]),t(g,{modelValue:r(l).pais,"onUpdate:modelValue":s[1]||(s[1]=e=>r(l).pais=e),label:"Pa\xEDs",class:"required q-my-md",outlined:""},null,8,["modelValue"])]),_:1})])])]),_:1})]),_:1})]),_:1}))}};export{G as default};
